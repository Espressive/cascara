{"version":3,"sources":["felaFocusVisibleEnhancer.ts"],"names":["felaFocusVisibleEnhancer","renderer","existingEmitChange","_emitChange","bind","change","type","RULE_TYPE","selector","indexOf","pseudo","replace"],"mappings":";;;;;AAAA;;AAGA;AACA;AACA;AACA;AACA;AACO,IAAMA,wBAAwB,GAAG,SAA3BA,wBAA2B,CAACC,QAAD,EAA4B;AAClE,MAAMC,kBAAkB,GAAGD,QAAQ,CAACE,WAAT,CAAqBC,IAArB,CAA0BH,QAA1B,CAA3B;;AAEAA,EAAAA,QAAQ,CAACE,WAAT,GAAuB,UAACE,MAAD,EAAgC;AACrD,QAAIA,MAAM,CAACC,IAAP,KAAgBC,oBAAhB,IAA6BF,MAAM,CAACG,QAAP,CAAgBC,OAAhB,CAAwB,gBAAxB,MAA8C,CAAC,CAAhF,EAAmF;AACjF;AACAJ,MAAAA,MAAM,CAACK,MAAP,GAAgBL,MAAM,CAACK,MAAP,GAAgBL,MAAM,CAACK,MAAP,CAAcC,OAAd,CAAsB,gBAAtB,EAAwC,QAAxC,CAAhB,GAAoE,EAApF;AACAN,MAAAA,MAAM,CAACG,QAAP,0CAAqDH,MAAM,CAACG,QAAP,CAAgBG,OAAhB,CAAwB,gBAAxB,EAA0C,QAA1C,CAArD;AACD;;AAEDT,IAAAA,kBAAkB,CAACG,MAAD,CAAlB;AACD,GARD;;AAUA,SAAOJ,QAAP;AACD,CAdM","sourcesContent":["import { RULE_TYPE } from 'fela-utils';\nimport { FelaRenderer, FelaRendererChange } from './types';\n\n/**\n * A Fela enhancer that allows to use `:focus-visible`. Uses `what-input` library and its global\n * selector. Modifies generated selectors:\n * `.a:focus-visible {}` => `html[data-whatinput=\"keyboard\"] a:focus`.\n */\nexport const felaFocusVisibleEnhancer = (renderer: FelaRenderer) => {\n  const existingEmitChange = renderer._emitChange.bind(renderer);\n\n  renderer._emitChange = (change: FelaRendererChange) => {\n    if (change.type === RULE_TYPE && change.selector.indexOf(':focus-visible') !== -1) {\n      // Fela uses objects by references, it's safe to override properties\n      change.pseudo = change.pseudo ? change.pseudo.replace(':focus-visible', ':focus') : '';\n      change.selector = `html[data-whatinput=\"keyboard\"] ${change.selector.replace(':focus-visible', ':focus')}`;\n    }\n\n    existingEmitChange(change);\n  };\n\n  return renderer;\n};\n"],"file":"felaFocusVisibleEnhancer.js"}