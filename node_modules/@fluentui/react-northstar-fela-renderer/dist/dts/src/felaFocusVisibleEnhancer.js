"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.felaFocusVisibleEnhancer = void 0;
var fela_utils_1 = require("fela-utils");
/**
 * A Fela enhancer that allows to use `:focus-visible`. Uses `what-input` library and its global
 * selector. Modifies generated selectors:
 * `.a:focus-visible {}` => `html[data-whatinput="keyboard"] a:focus`.
 */
var felaFocusVisibleEnhancer = function (renderer) {
    var existingEmitChange = renderer._emitChange.bind(renderer);
    renderer._emitChange = function (change) {
        if (change.type === fela_utils_1.RULE_TYPE && change.selector.indexOf(':focus-visible') !== -1) {
            // Fela uses objects by references, it's safe to override properties
            change.pseudo = change.pseudo ? change.pseudo.replace(':focus-visible', ':focus') : '';
            change.selector = "html[data-whatinput=\"keyboard\"] " + change.selector.replace(':focus-visible', ':focus');
        }
        existingEmitChange(change);
    };
    return renderer;
};
exports.felaFocusVisibleEnhancer = felaFocusVisibleEnhancer;
