{"version":3,"sources":["components/Chat/ChatMessage.tsx"],"names":["chatMessageBehavior","IS_FOCUSABLE_ATTRIBUTE","keyboardKey","menuAsToolbarBehavior","getElementType","useAccessibility","useAutoControlled","useContextSelector","useFluentContext","useStyles","useTelemetry","useUnhandledProps","Ref","customPropTypes","cx","PropTypes","React","childrenExist","commonPropTypes","createShorthand","createShorthandFactory","getOrGenerateIdFromShorthand","rtlTextContainer","getScrollParent","partitionPopperPropsFromShorthand","usePopper","Box","Flex","Label","Menu","PortalInner","Reaction","Text","useChatDensityContext","ChatItemContext","ChatMessageDetails","ChatMessageHeader","ChatMessageReadStatus","chatMessageClassName","chatMessageSlotClassNames","actionMenu","author","badge","bar","compactBody","content","reactionGroup","timestamp","partitionActionMenuPropsFromShorthand","value","Array","isArray","inline","showActionMenu","props","ChatMessage","context","displayName","telemetry","setStart","setEnd","parentAttached","v","attached","chatDensity","accessibility","badgePosition","children","className","density","design","details","header","mine","positionActionMenu","reactionGroupPosition","readStatus","styles","overflow","unstable_overflow","variables","actionMenuOptions","positioningProps","inlineActionMenu","controlledShowActionMenu","defaultValue","setShowActionMenu","hasActionMenu","actionMenuId","useRef","current","modifiers","useCallback","target","container","name","options","fallbackPlacements","boundary","popperRef","align","position","positionFixed","enabled","messageRef","targetRef","actionsMenuRef","containerRef","useState","focused","setFocused","getA11Props","actionHandlers","preventDefault","event","currentTarget","focus","stopPropagation","debugName","mapPropsToBehavior","rtl","mapPropsToStyles","hasBadge","hasReactionGroup","mapPropsToInlineStyles","classes","resolvedStyles","handleFocus","e","updatePosition","handleBlur","shouldPreserveFocusState","relatedTarget","handleMouseEnter","handleMouseLeave","renderActionMenu","actionMenuElement","create","defaultProps","overrideProps","id","handleKeyDown","toFocusItemInActionMenu","querySelector","querySelectorAll","keyCode","Enter","Tab","isShift","shiftKey","focusableElementsInsideMessage","firstFocusableInsideMessage","lastFocusableInsideMessage","length","boundaryElementInsideMessage","childrenPropExists","rootClasses","root","ElementType","unhandledProps","handledProps","badgeElement","reactionGroupElement","Group","authorElement","size","undefined","timestampElement","messageContent","detailsElement","readStatusElement","elements","headerElement","bodyElement","element","unstable_wrapWithFocusZone","onBlur","onFocus","onMouseEnter","onMouseLeave","onKeyDown","getAttributes","forElements","propTypes","createCommon","oneOfType","itemShorthand","collectionShorthand","bool","oneOf","func","Object","keys","Component","mappedProp"],"mappings":"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","sourcesContent":["import {\n  Accessibility,\n  chatMessageBehavior,\n  ChatMessageBehaviorProps,\n  IS_FOCUSABLE_ATTRIBUTE,\n  keyboardKey,\n  menuAsToolbarBehavior,\n} from '@fluentui/accessibility';\nimport {\n  ComponentWithAs,\n  getElementType,\n  useAccessibility,\n  useAutoControlled,\n  useContextSelector,\n  useFluentContext,\n  useStyles,\n  useTelemetry,\n  useUnhandledProps,\n} from '@fluentui/react-bindings';\nimport { Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport cx from 'classnames';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  ComponentEventHandler,\n  ComponentKeyboardEventHandler,\n  FluentComponentStaticProps,\n  ObjectShorthandValue,\n  ShorthandCollection,\n  ShorthandValue,\n} from '../../types';\nimport {\n  ChildrenComponentProps,\n  childrenExist,\n  commonPropTypes,\n  ContentComponentProps,\n  createShorthand,\n  createShorthandFactory,\n  getOrGenerateIdFromShorthand,\n  rtlTextContainer,\n  UIComponentProps,\n} from '../../utils';\nimport {\n  getScrollParent,\n  partitionPopperPropsFromShorthand,\n  PopperModifiersFn,\n  PopperRefHandle,\n  PopperShorthandProps,\n  usePopper,\n} from '../../utils/positioner';\nimport { Box, BoxProps } from '../Box/Box';\nimport { Flex } from '../Flex/Flex';\nimport { Label, LabelProps } from '../Label/Label';\nimport { Menu, MenuProps } from '../Menu/Menu';\nimport { MenuItemProps } from '../Menu/MenuItem';\nimport { PortalInner } from '../Portal/PortalInner';\nimport { Reaction, ReactionProps } from '../Reaction/Reaction';\nimport { ReactionGroupProps } from '../Reaction/ReactionGroup';\nimport { Text, TextProps } from '../Text/Text';\nimport { ChatDensity, useChatDensityContext } from './chatDensityContext';\nimport { ChatItemContext } from './chatItemContext';\nimport { ChatMessageDetails, ChatMessageDetailsProps } from './ChatMessageDetails';\nimport { ChatMessageHeader, ChatMessageHeaderProps } from './ChatMessageHeader';\nimport { ChatMessageReadStatus, ChatMessageReadStatusProps } from './ChatMessageReadStatus';\n\nexport interface ChatMessageSlotClassNames {\n  actionMenu: string;\n  author: string;\n  badge: string;\n  bar: string;\n  compactBody: string;\n  content: string;\n  reactionGroup: string;\n  timestamp: string;\n}\n\nexport interface ChatMessageProps\n  extends UIComponentProps,\n    ChildrenComponentProps,\n    ContentComponentProps<ShorthandValue<BoxProps>> {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<ChatMessageBehaviorProps>;\n\n  /**\n   * Menu with actions of the message.\n   * popper: alters the action menu positioning.\n   * inline: whether the action menu should be rendered inline with the chat message, or in the body. It's true by default.\n   * showActionMenu: controls if the action menu is visible or not.\n   */\n  actionMenu?:\n    | ShorthandValue<MenuProps & { popper?: PopperShorthandProps; inline?: boolean; showActionMenu?: boolean }>\n    | ShorthandCollection<MenuItemProps & { inline?: boolean; showActionMenu?: boolean }>;\n\n  /** Controls messages's relation to other chat messages. Is automatically set by the ChatItem. */\n  attached?: boolean | 'top' | 'bottom';\n\n  /** Author of the message. */\n  author?: ShorthandValue<TextProps>;\n\n  /** Badge attached to the message. */\n  badge?: ShorthandValue<LabelProps>;\n\n  /** A message can format the badge to appear at the start or the end of the message. */\n  badgePosition?: 'start' | 'end';\n\n  /** A message can have a custom body. Only rendered in compact density. */\n  compactBody?: ShorthandValue<BoxProps>;\n\n  /** Chat density. Is automatically set by the Chat. */\n  density?: ChatDensity;\n\n  /** Message details info slot. Displayed in the header or body in comfy and compact density respectively. */\n  details?: ShorthandValue<ChatMessageDetailsProps>;\n\n  /** A message can have a custom header. */\n  header?: ShorthandValue<ChatMessageHeaderProps>;\n\n  /** Indicates whether message belongs to the current user. */\n  mine?: boolean;\n\n  /**\n   * Called after user's blur.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onBlur?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user's focus.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onFocus?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called on chat message item key down.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onKeyDown?: ComponentKeyboardEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user enters by mouse.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onMouseEnter?: ComponentEventHandler<ChatMessageProps>;\n\n  /**\n   * Called after user leaves by mouse.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onMouseLeave?: ComponentEventHandler<ChatMessageProps>;\n\n  /** Allows suppression of action menu positioning for performance reasons. */\n  positionActionMenu?: boolean;\n\n  /** Reaction group applied to the message. */\n  reactionGroup?: ShorthandValue<ReactionGroupProps> | ShorthandCollection<ReactionProps>;\n\n  /** A message can format the reactions group to appear at the start or the end of the message. */\n  reactionGroupPosition?: 'start' | 'end';\n\n  /** Message read status indicator. */\n  readStatus?: ShorthandValue<ChatMessageReadStatusProps>;\n\n  /** Timestamp of the message. */\n  timestamp?: ShorthandValue<TextProps>;\n\n  /** Positions an actionMenu slot in \"fixed\" mode. */\n  unstable_overflow?: boolean;\n}\n\nexport type ChatMessageStylesProps = Pick<ChatMessageProps, 'attached' | 'badgePosition' | 'density' | 'mine'> & {\n  hasBadge: boolean;\n  hasReactionGroup: boolean;\n\n  // focused, hasActionMenu and showActionMenu controls the visibility of action menu\n  focused: boolean;\n  hasActionMenu: boolean;\n  showActionMenu: boolean;\n};\n\nexport const chatMessageClassName = 'ui-chat__message';\nexport const chatMessageSlotClassNames: ChatMessageSlotClassNames = {\n  actionMenu: `${chatMessageClassName}__actions`,\n  author: `${chatMessageClassName}__author`,\n  badge: `${chatMessageClassName}__badge`,\n  bar: `${chatMessageClassName}__bar`,\n  compactBody: `${chatMessageClassName}__compact-body`,\n  content: `${chatMessageClassName}__content`,\n  reactionGroup: `${chatMessageClassName}__reactions`,\n  timestamp: `${chatMessageClassName}__timestamp`,\n};\n\nfunction partitionActionMenuPropsFromShorthand<P>(\n  value: ShorthandValue<P & { inline?: boolean; showActionMenu?: boolean }>,\n): [ShorthandValue<P> | ObjectShorthandValue<P>, boolean | undefined, boolean | undefined] {\n  if (typeof value === 'object' && value !== null && !Array.isArray(value)) {\n    const { inline, showActionMenu, ...props } = value as ObjectShorthandValue<P> & {\n      inline?: boolean;\n      showActionMenu?: boolean;\n    };\n\n    return [props as ObjectShorthandValue<P>, inline ?? true, showActionMenu];\n  }\n\n  return [value, true, false];\n}\n\n/**\n * A ChatMessage represents a single message in chat.\n */\nexport const ChatMessage: ComponentWithAs<'div', ChatMessageProps> &\n  FluentComponentStaticProps<ChatMessageProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(ChatMessage.displayName, context.telemetry);\n  setStart();\n\n  const parentAttached = useContextSelector(ChatItemContext, v => v.attached);\n  const chatDensity = useChatDensityContext();\n  const {\n    accessibility,\n    attached = parentAttached,\n    author,\n    badge,\n    badgePosition,\n    children,\n    className,\n    compactBody,\n    content,\n    density = chatDensity,\n    design,\n    details,\n    header,\n    mine,\n    positionActionMenu,\n    reactionGroup,\n    reactionGroupPosition,\n    readStatus,\n    styles,\n    timestamp,\n    unstable_overflow: overflow,\n    variables,\n  } = props;\n\n  const [actionMenuOptions, positioningProps] = partitionPopperPropsFromShorthand(props.actionMenu);\n  const [actionMenu, inlineActionMenu, controlledShowActionMenu] = partitionActionMenuPropsFromShorthand(\n    actionMenuOptions,\n  );\n  const [showActionMenu, setShowActionMenu] = useAutoControlled<boolean>({\n    defaultValue: false,\n    value: controlledShowActionMenu,\n  });\n  const hasActionMenu = !_.isNil(actionMenu);\n\n  const actionMenuId = React.useRef<string>();\n  actionMenuId.current = getOrGenerateIdFromShorthand(`${chatMessageClassName}-`, actionMenu, actionMenuId.current);\n\n  const modifiers = React.useCallback<PopperModifiersFn>(\n    (target, container) => {\n      return (\n        positionActionMenu && [\n          // https://popper.js.org/docs/v2/modifiers/flip/\n          // Forces to flip only in \"top-*\" positions\n          { name: 'flip', options: { fallbackPlacements: ['top'] } },\n          overflow && {\n            name: 'preventOverflow',\n            options: { boundary: getScrollParent(container) },\n          },\n        ]\n      );\n    },\n    [positionActionMenu, overflow],\n  );\n\n  const popperRef = React.useRef<PopperRefHandle>();\n  const { targetRef: messageRef, containerRef: actionsMenuRef } = usePopper({\n    align: 'end',\n    position: 'above',\n    positionFixed: overflow,\n\n    enabled: hasActionMenu && positionActionMenu,\n    modifiers,\n    popperRef,\n\n    ...positioningProps,\n  });\n\n  // `focused` state is used for show/hide actionMenu\n  const [focused, setFocused] = React.useState<boolean>(false);\n\n  const getA11Props = useAccessibility(accessibility, {\n    actionHandlers: {\n      // prevents default FocusZone behavior, e.g., in ChatMessageBehavior, it prevents FocusZone from using arrow keys\n      // as navigation (only Tab key should work)\n      preventDefault: event => {\n        // preventDefault only if event coming from inside the message\n        if (event.currentTarget !== event.target) {\n          event.preventDefault();\n        }\n      },\n\n      focus: event => {\n        if (messageRef.current) {\n          messageRef.current.focus();\n          event.stopPropagation();\n        }\n      },\n    },\n    debugName: ChatMessage.displayName,\n    mapPropsToBehavior: () => ({\n      hasActionMenu,\n      inlineActionMenu,\n      actionMenuId: actionMenuId.current,\n    }),\n    rtl: context.rtl,\n  });\n\n  const { classes, styles: resolvedStyles } = useStyles<ChatMessageStylesProps>(ChatMessage.displayName, {\n    className: chatMessageClassName,\n    mapPropsToStyles: () => ({\n      attached,\n      badgePosition,\n      density,\n      focused,\n      hasActionMenu,\n      hasBadge: !!badge,\n      hasReactionGroup: !!reactionGroup,\n      mine,\n      showActionMenu,\n    }),\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const handleFocus = (e: React.SyntheticEvent) => {\n    popperRef.current?.updatePosition();\n\n    // react onFocus is called even when nested component receives focus (i.e. it bubbles)\n    // so when focus moves within actionMenu, the `focus` state in chatMessage remains true, and keeps actionMenu visible\n    setFocused(true);\n    _.invoke(props, 'onFocus', e, props);\n  };\n\n  const handleBlur = (e: React.SyntheticEvent) => {\n    // `focused` controls is focused the whole `ChatMessage` or any of its children. When we're navigating\n    // with keyboard the focused element will be changed and there is no way to use `:focus` selector\n    const shouldPreserveFocusState = _.invoke(e, 'currentTarget.contains', (e as any).relatedTarget);\n\n    setFocused(shouldPreserveFocusState);\n    setShowActionMenu(false);\n\n    _.invoke(props, 'onBlur', e, props);\n  };\n\n  const handleMouseEnter = (e: React.SyntheticEvent) => {\n    popperRef.current?.updatePosition();\n    if (hasActionMenu && !inlineActionMenu) {\n      setShowActionMenu(true);\n    }\n    _.invoke(props, 'onMouseEnter', e, props);\n  };\n\n  const handleMouseLeave = (e: React.SyntheticEvent) => {\n    if (!focused && hasActionMenu && !inlineActionMenu) {\n      setShowActionMenu(false);\n    }\n    _.invoke(props, 'onMouseLeave', e, props);\n  };\n\n  const renderActionMenu = () => {\n    const actionMenuElement = Menu.create(actionMenu, {\n      defaultProps: () => ({\n        [IS_FOCUSABLE_ATTRIBUTE]: true,\n        accessibility: menuAsToolbarBehavior,\n        className: chatMessageSlotClassNames.actionMenu,\n        styles: resolvedStyles.actionMenu,\n      }),\n      overrideProps: {\n        id: actionMenuId.current,\n      },\n    });\n\n    const content = actionMenuElement ? <Ref innerRef={actionsMenuRef}>{actionMenuElement}</Ref> : actionMenuElement;\n\n    return inlineActionMenu || !content ? content : <PortalInner>{content}</PortalInner>;\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (hasActionMenu && !inlineActionMenu) {\n      // reference: https://github.com/microsoft/fluentui/pull/17329\n\n      const toFocusItemInActionMenu =\n        actionsMenuRef.current?.querySelector('[tabindex=\"0\"]') ??\n        actionsMenuRef.current?.querySelectorAll('[tabindex=\"-1\"]:not([data-is-focusable=\"false\"])')[0];\n\n      if (e.keyCode === keyboardKey.Enter) {\n        toFocusItemInActionMenu?.focus();\n        e.stopPropagation();\n        e.preventDefault();\n      }\n\n      if (e.keyCode === keyboardKey.Tab) {\n        // TAB/SHIFT+TAB cycles focus among actionMenu and focusable elements within chat message\n        const isShift = !!e.shiftKey;\n\n        const focusableElementsInsideMessage: NodeListOf<HTMLElement> = e.currentTarget.querySelectorAll(\n          '[tabindex=\"-1\"]:not([data-is-focusable=\"false\"])',\n        );\n        const firstFocusableInsideMessage = focusableElementsInsideMessage[0];\n        const lastFocusableInsideMessage = focusableElementsInsideMessage[focusableElementsInsideMessage.length - 1];\n\n        if (e.target === toFocusItemInActionMenu) {\n          // focus is now inside action menu\n          // cycle focus into the first/last focusable element inside chat message\n          if (isShift) {\n            lastFocusableInsideMessage?.focus();\n          } else {\n            firstFocusableInsideMessage?.focus();\n          }\n          e.stopPropagation();\n          e.preventDefault();\n        } else {\n          const boundaryElementInsideMessage = isShift ? firstFocusableInsideMessage : lastFocusableInsideMessage;\n          if (e.target === boundaryElementInsideMessage) {\n            // focus is now on the first/last focusable element inside chat message\n            toFocusItemInActionMenu.focus(); // cycle focus back into action Menu\n            e.stopPropagation();\n            e.preventDefault();\n          }\n        }\n      }\n    }\n    _.invoke(props, 'onKeyDown', e, props);\n  };\n\n  const childrenPropExists = childrenExist(children);\n  const rootClasses = childrenPropExists ? cx(classes.root, classes.content) : classes.root;\n\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(ChatMessage.handledProps, props);\n\n  const badgeElement = Label.create(badge, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.badge,\n      styles: resolvedStyles.badge,\n    }),\n  });\n\n  const reactionGroupElement = Reaction.Group.create(reactionGroup, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.reactionGroup,\n      styles: resolvedStyles.reactionGroup,\n    }),\n  });\n\n  const actionMenuElement = renderActionMenu();\n\n  const authorElement = Text.create(author, {\n    defaultProps: () => ({\n      size: density === 'comfy' ? 'small' : undefined,\n      styles: resolvedStyles.author,\n      className: chatMessageSlotClassNames.author,\n    }),\n  });\n\n  const timestampElement = Text.create(timestamp, {\n    defaultProps: () => ({\n      size: 'small',\n      styles: resolvedStyles.timestamp,\n      timestamp: true,\n      className: chatMessageSlotClassNames.timestamp,\n    }),\n  });\n\n  const messageContent = Box.create(content, {\n    defaultProps: () => ({\n      className: chatMessageSlotClassNames.content,\n      styles: resolvedStyles.content,\n    }),\n  });\n\n  const detailsElement = createShorthand(ChatMessageDetails, details, {\n    defaultProps: () => ({ attached, density, mine }),\n  });\n\n  const readStatusElement = createShorthand(ChatMessageReadStatus, readStatus, {\n    defaultProps: () => ({ density }),\n  });\n\n  let elements = <></>;\n  if (density === 'compact') {\n    const headerElement = createShorthand(ChatMessageHeader, header);\n\n    const bodyElement = Box.create(compactBody, {\n      defaultProps: () =>\n        getA11Props('compactBody', {\n          className: chatMessageSlotClassNames.compactBody,\n          styles: resolvedStyles.compactBody,\n        }),\n      overrideProps: () => ({\n        content: (\n          <>\n            <Flex.Item grow={1}>\n              <div>\n                {authorElement}\n                {messageContent}\n              </div>\n            </Flex.Item>\n            {timestampElement}\n            {detailsElement}\n            {badgeElement}\n          </>\n        ),\n      }),\n    });\n\n    elements = (\n      <>\n        {actionMenuElement}\n        <div className={chatMessageSlotClassNames.bar} />\n        {headerElement}\n        {bodyElement}\n        {reactionGroupElement}\n        {readStatusElement}\n      </>\n    );\n  } else {\n    const headerElement = createShorthand(ChatMessageHeader, header || {}, {\n      overrideProps: () => ({\n        content: (\n          <>\n            {authorElement}\n            {timestampElement}\n            {detailsElement}\n            {reactionGroupPosition === 'start' && reactionGroupElement}\n          </>\n        ),\n      }),\n    });\n\n    elements = (\n      <>\n        {actionMenuElement}\n        <div className={chatMessageSlotClassNames.bar} />\n        {badgePosition === 'start' && badgeElement}\n        {headerElement}\n        {messageContent}\n        {reactionGroupPosition === 'end' && reactionGroupElement}\n        {badgePosition === 'end' && badgeElement}\n        {readStatusElement}\n      </>\n    );\n  }\n\n  const element = (\n    <Ref innerRef={messageRef}>\n      {getA11Props.unstable_wrapWithFocusZone(\n        <ElementType\n          {...getA11Props('root', {\n            className: rootClasses,\n            onBlur: handleBlur,\n            onFocus: handleFocus,\n            onMouseEnter: handleMouseEnter,\n            onMouseLeave: handleMouseLeave,\n            onKeyDown: handleKeyDown,\n            ...rtlTextContainer.getAttributes({ forElements: [children] }),\n            ...unhandledProps,\n          })}\n        >\n          {childrenPropExists ? children : elements}\n        </ElementType>,\n      )}\n    </Ref>\n  );\n  setEnd();\n\n  return element;\n};\n\nChatMessage.displayName = 'ChatMessage';\n\nChatMessage.defaultProps = {\n  accessibility: chatMessageBehavior,\n  badgePosition: 'end',\n  compactBody: {},\n  positionActionMenu: true,\n  reactionGroupPosition: 'start',\n};\n\nChatMessage.propTypes = {\n  ...commonPropTypes.createCommon({ content: 'shorthand' }),\n  actionMenu: PropTypes.oneOfType([customPropTypes.itemShorthand, customPropTypes.collectionShorthand]),\n  attached: PropTypes.oneOfType([PropTypes.bool, PropTypes.oneOf<'top' | 'bottom'>(['top', 'bottom'])]),\n  author: customPropTypes.itemShorthand,\n  badge: customPropTypes.itemShorthand,\n  badgePosition: PropTypes.oneOf(['start', 'end']),\n  compactBody: customPropTypes.itemShorthand,\n  density: PropTypes.oneOf<ChatDensity>(['comfy', 'compact']),\n  details: customPropTypes.itemShorthand,\n  header: customPropTypes.itemShorthand,\n  mine: PropTypes.bool,\n  onBlur: PropTypes.func,\n  onFocus: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  positionActionMenu: PropTypes.bool,\n  reactionGroup: PropTypes.oneOfType([customPropTypes.collectionShorthand, customPropTypes.itemShorthand]),\n  reactionGroupPosition: PropTypes.oneOf(['start', 'end']),\n  readStatus: customPropTypes.itemShorthand,\n  timestamp: customPropTypes.itemShorthand,\n  unstable_overflow: PropTypes.bool,\n};\n\nChatMessage.handledProps = Object.keys(ChatMessage.propTypes) as any;\n\nChatMessage.create = createShorthandFactory({ Component: ChatMessage, mappedProp: 'content' });\n"],"file":"ChatMessage.js"}