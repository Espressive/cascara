"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createPostMessageConnect = createPostMessageConnect;

var _playground = require("../playground");

function createPostMessageConnect() {
  function postMessage(msg) {
    parent.postMessage(msg, '*');
  }

  return {
    postMessage: postMessage,
    onMessage: function onMessage(_onMessage) {
      function handleMessage(msg) {
        _onMessage(msg.data);
      }

      window.addEventListener('message', handleMessage, false);
      var removeShortcuts = (0, _playground.registerShortcuts)(function (command) {
        postMessage({
          type: 'playgroundCommand',
          payload: {
            command: command
          }
        });
      });
      return function () {
        window.removeEventListener('message', handleMessage);
        removeShortcuts();
      };
    }
  };
}